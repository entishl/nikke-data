# ADR-001: 国际化方案选型

*   **状态:** 已接受
*   **日期:** 2025-09-19

## 背景 (Context)

随着项目的发展，为了满足全球用户的需求，我们需要为前端应用引入多语言支持。这要求我们选择一个稳定、高效且与现有技术栈 (Vue 3, Vite) 兼容的国际化 (i18n) 解决方案。

## 决策 (Decision)

我们决定采用 `vue-i18n@next` 作为项目的核心国际化库。

围绕此核心，我们制定了以下完整的技术方案：

1.  **核心库:** `vue-i18n@next`，因为它为 Vue 3 提供了官方支持和优秀的 Composition API 集成。
2.  **语言包管理:**
    *   所有语言文件 (如 `en.json`, `zh-CN.json`) 均存储在 `src/locales/` 目录下。
    *   采用 JSON 格式，结构清晰，易于维护和机器翻译。
3.  **状态管理集成:**
    *   用户的语言偏好设置 (locale) 持久化在 Pinia store (`unionStore`) 中，并同步到 `localStorage`。
    *   应用初始化时，会优先从 Pinia store 读取用户的语言设置。
4.  **性能优化:**
    *   语言包采用**懒加载 (Lazy Loading)** 机制。在 `src/plugins/i18n.js` 中，我们使用动态 `import()` 按需加载当前语言对应的 JSON 文件，避免在应用初始化时加载所有语言包，从而优化首屏加载性能。
5.  **封装与使用:**
    *   在 Vue 组件中，通过 `useI18n()` composable 来使用翻译功能。
    *   在普通的 JavaScript 模块中（如 services 或 stores），通过 `i18n.global.t()` 来访问全局的翻译函数。
    *   创建了一个 `useLocale` composable (`src/composables/useLocale.js`) 来封装切换语言的逻辑，使其可以在任何组件中被方便地调用。

## 后果 (Consequences)

### 积极的
*   项目现在具备了完整的、可扩展的国际化能力。
*   基于 `vue-i18n` 的成熟生态，未来可以轻松集成更多的 i18n 工具。
*   懒加载机制确保了在增加新语言时，不会对现有用户的性能造成影响。
*   开发流程清晰，有明确的指南可供遵循。

### 消极的
*   所有面向用户的字符串都必须经过 i18n 处理，增加了开发的步骤。
*   需要维护多份语言文件，保证其 key 的同步和翻译的准确性。

### 结论
所有新功能的开发都必须遵循本 ADR 和 `FRONTEND_DEV_GUIDE.md` 中定义的 i18n 规范。